<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {version} from "../package.json";
import {UnsupportedInteraction} from "./interaction";
import {TREZOR, TrezorGetMetadata, TrezorExportPublicKey, TrezorExportExtendedPublicKey, TrezorSignMultisigTransaction, TrezorConfirmMultisigAddress} from "./trezor";
import {LEDGER, LedgerGetMetadata, LedgerExportPublicKey, LedgerSignMultisigTransaction} from "./ledger";
import {HERMIT, HermitExportPublicKey, HermitExportExtendedPublicKey, HermitSignTransaction} from "./hermit";

/**
 * Current unchained-wallets version.
 *
 * @type {string}
 */
export const VERSION = version;

/**
 * Enumeration of keystores which support direct interactions.
 *
 * @constant
 * @enum {string}
 * @default
 */
export const DIRECT_KEYSTORES = {TREZOR, LEDGER};

/**
 * Enumeration of keystores which support indirect interactions.
 *
 * @constant
 * @enum {string}
 * @default
 */
export const INDIRECT_KEYSTORES = {HERMIT};

/**
 * Enumeration of supported keystores.
 *
 * @type {string[]}
 */
export const KEYSTORES = {...DIRECT_KEYSTORES, ...INDIRECT_KEYSTORES};


/**
 * Return an interaction class for obtaining metadata from the given
 * `keystore`.
 *
 * **Supported keystores:** Trezor, Ledger
 *
 * @param {Object} options - options argument
 * @param {KEYSTORES} options.keystore - keystore to use
 * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance
 * @example
 * import {GetMetadata, TREZOR} from "unchained-wallets";
 * // Works similarly for Ledger.
 * const interaction = GetMetadata({keystore: TREZOR});
 * const metadata = await interaction.run();
 */
export function GetMetadata({keystore}) {
  switch (keystore) {
  case TREZOR:
    return new TrezorGetMetadata();
  case LEDGER:
    return new LedgerGetMetadata();
  default:
    return new UnsupportedInteraction({code: "unsupported", text: "This keystore does not return a version."});
  }
}

/**
 * Return an interaction class for exporting a public key from the
 * given `keystore` for the given `bip32Path` and `network`.
 *
 * **Supported keystores:** Trezor, Ledger, Hermit
 * 
 * @param {Object} options - options argument
 * @param {KEYSTORES} options.keystore - keystore to use
 * @param {string} options.network - bitcoin network
 * @param {string} options.bip32Path - the BIP32 path of the HD node of the public key
 * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance
 * @example
 * import {MAINNET} from "unchained-bitcoin";
 * import {ExportPublicKey, TREZOR, HERMIT} from "unchained-wallets";
 * // Works similarly for Ledger
 * const interaction = ExportPublicKey({keystore: TREZOR, network: MAINNET, bip32Path: "m/45'/0'/0'/0/0"});
 * const publicKey = await interaction.run();
 */
export function ExportPublicKey({keystore, network, bip32Path}) {
  switch (keystore) {
  case TREZOR:
    return new TrezorExportPublicKey({network, bip32Path});
  case LEDGER:
    return new LedgerExportPublicKey({bip32Path});
  case HERMIT:
    return new HermitExportPublicKey({bip32Path});
  default:
    return new UnsupportedInteraction({code: "unsupported", text: "This keystore is not supported when exporting public keys."});
  }
}

/**
 * Return an interaction class for exporting an extended public key
 * from the given `keystore` for the given `bip32Path` and `network`.
 *
 * **Supported keystores:** Trezor, Hermit
 *
 *
 * @param {Object} options - options argument
 * @param {KEYSTORES} options.keystore - keystore to use
 * @param {string} options.network - bitcoin network
 * @param {string} options.bip32Path - the BIP32 path of the HD node of the extended public key
 * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance
 * @example
 * import {MAINNET} from "unchained-bitcoin";
 * import {ExportExtendedPublicKey, TREZOR, HERMIT} from "unchained-wallets";
 * // Works similarly for Ledger
 * const interaction = ExportExtendedPublicKey({keystore: TREZOR, network: MAINNET, bip32Path: "m/45'/0'/0'/0/0"});
 * const xpub = await interaction.run();
 */
export function ExportExtendedPublicKey({keystore, network, bip32Path}) {
  switch (keystore) {
  case TREZOR:
    return new TrezorExportExtendedPublicKey({network, bip32Path});
  case HERMIT:
    return new HermitExportExtendedPublicKey({bip32Path});
  default:
    return new UnsupportedInteraction({code: "unsupported", text: "This keystore is not supported when exporting extended public keys."});
  }
}

/**
 * Return an interaction class for signing a multisig transaction with
 * the given `keystore`.
 *
 * The inputs are objects which have `txid`, `index`, and a `multisig`
 * object, the last which is a `Multisig` object from
 * `unchained-bitcoin`.
 *
 * The outputs are objects which have `address` and `amountSats` (an
 * integer).
 *
 * `bip32Paths` is an array of BIP32 paths for the public keys on this
 * device, one for each input.
 *
 * **Supported keystores:** Trezor, Ledger, Hermit
 *
 *
 * @param {Object} options - options argument
 * @param {KEYSTORES} options.keystore - keystore to use
 * @param {string} options.network - bitcoin network
 * @param {object[]} options.inputs - transaction inputs
 * @param {object[]} options.outputs - transaction outputs
 * @param {string[]} options.bip32Paths - the BIP32 paths on this device corresponding to a public key in each input
 * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance
 * @example
 * import {
 *   generateMultisigFromHex, TESTNET, P2SH,
 * } from "unchained-bitcoin";
 * import {SignMultisigTransaction, TREZOR} from "unchained-wallets";
 * const redeemScript = "5...ae";
 * const inputs = [
 *   {
 *     txid: "8d276c76b3550b145e44d35c5833bae175e0351b4a5c57dc1740387e78f57b11",
 *     index: 1,
 *     multisig: generateMultisigFromHex(TESTNET, P2SH, redeemScript),
 *     amountSats: '1234000'
 *   },
 *   // other inputs...
 * ];
 * const outputs = [
 *   {
 *     amountSats: '1299659',
 *     address: "2NGHod7V2TAAXC1iUdNmc6R8UUd4TVTuBmp"
 *   },
 *   // other outputs...
 * ];
 * const interaction = SignMultisigTransaction({
 *   keystore: TREZOR, // works the same for Ledger
 *   network: TESTNET,
 *   inputs,
 *   outputs,
 *   bip32Paths: ["m/45'/0'/0'/0", // add more, 1 per input],
 * });
 * const signature = await interaction.run();
 * console.log(signatures);
 * // ["ababab...", // 1 per input]
 * 
 */
export function SignMultisigTransaction({keystore, network, inputs, outputs, bip32Paths}) {
  switch (keystore) {
  case TREZOR:
    return new TrezorSignMultisigTransaction({network, inputs, outputs, bip32Paths});
  case LEDGER:
    return new LedgerSignMultisigTransaction({network, inputs, outputs, bip32Paths});
  case HERMIT:
    return new HermitSignTransaction({inputs, outputs, bip32Paths});
  default:
    return new UnsupportedInteraction({code: "unsupported", text: "This keystore is not supported when signing multisig transactions."});
  }
}

/**
 * Return an interaction class for confirming a multisig addreess with
 * the given `keystore`.
 *
 * The `multisig` parameter is a `Multisig` object from
 * `unchained-bitcoin`.
 *
 * `bip32Path` is the BIP32 path for the publiic key in the address on
 * this device.
 *
 * **Supported keystores:** Trezor
 *
 * @param {Object} options - options argument
 * @param {KEYSTORES} options.keystore - keystore to use
 * @param {string} options.network - bitcoin network
 * @param {object} options.multisig - `Multisig` object representing the address
 * @param {string} options.bip32Path - the BIP32 path on this device containing a public key from the address
 * @return {module:interaction.KeystoreInteraction} keystore-specific interaction instance
 * @example
 * import {
 *   generateMultisigFromHex, TESTNET, P2SH,
 * } from "unchained-bitcoin";
 * import {ConfirmMultisigAddress, TREZOR} from "unchained-wallets";
 * const redeemScript = "5...ae";
 * const multisig = generateMultisigFromHex(TESTNET, P2SH, redeemScript);
 * const interaction = ConfirmMultisigAddress({
 *   keystore: TREZOR,
 *   network: TESTNET,
 *   multisig,
 *   bip32Path: "m/45'/1'/0'/0/0",
 * });
 * await interaction.run();
 * 
 */
export function ConfirmMultisigAddress({keystore, network, bip32Path, multisig}) {
  switch (keystore) {
  case TREZOR:
    return new TrezorConfirmMultisigAddress({network, bip32Path, multisig});
  default:
    return new UnsupportedInteraction({code: "unsupported", text: "This keystore is not supported when confirming multisig addresses."});
  }
}

export * from "./interaction";
export * from "./trezor";
export * from "./ledger";
export * from "./hermit";
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-hermit.html">hermit</a></li><li><a href="module-interaction.html">interaction</a></li><li><a href="module-ledger.html">ledger</a></li><li><a href="module-trezor.html">trezor</a></li></ul><h3>Classes</h3><ul><li><a href="module-hermit.HermitDisplayer.html">HermitDisplayer</a></li><li><a href="module-hermit.HermitExportExtendedPublicKey.html">HermitExportExtendedPublicKey</a></li><li><a href="module-hermit.HermitExportPublicKey.html">HermitExportPublicKey</a></li><li><a href="module-hermit.HermitInteraction.html">HermitInteraction</a></li><li><a href="module-hermit.HermitReader.html">HermitReader</a></li><li><a href="module-hermit.HermitSignTransaction.html">HermitSignTransaction</a></li><li><a href="module-interaction.DirectKeystoreInteraction.html">DirectKeystoreInteraction</a></li><li><a href="module-interaction.IndirectKeystoreInteraction.html">IndirectKeystoreInteraction</a></li><li><a href="module-interaction.KeystoreInteraction.html">KeystoreInteraction</a></li><li><a href="module-interaction.UnsupportedInteraction.html">UnsupportedInteraction</a></li><li><a href="module-ledger.LedgerBitcoinInteraction.html">LedgerBitcoinInteraction</a></li><li><a href="module-ledger.LedgerDashboardInteraction.html">LedgerDashboardInteraction</a></li><li><a href="module-ledger.LedgerExportPublicKey.html">LedgerExportPublicKey</a></li><li><a href="module-ledger.LedgerGetMetadata.html">LedgerGetMetadata</a></li><li><a href="module-ledger.LedgerInteraction.html">LedgerInteraction</a></li><li><a href="module-ledger.LedgerSignMultisigTransaction.html">LedgerSignMultisigTransaction</a></li><li><a href="module-ledger-LedgerExportHDNode.html">LedgerExportHDNode</a></li><li><a href="module-trezor.TrezorConfirmMultisigAddress.html">TrezorConfirmMultisigAddress</a></li><li><a href="module-trezor.TrezorExportExtendedPublicKey.html">TrezorExportExtendedPublicKey</a></li><li><a href="module-trezor.TrezorExportHDNode.html">TrezorExportHDNode</a></li><li><a href="module-trezor.TrezorExportPublicKey.html">TrezorExportPublicKey</a></li><li><a href="module-trezor.TrezorGetMetadata.html">TrezorGetMetadata</a></li><li><a href="module-trezor.TrezorInteraction.html">TrezorInteraction</a></li><li><a href="module-trezor.TrezorSignMultisigTransaction.html">TrezorSignMultisigTransaction</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ConfirmMultisigAddress">ConfirmMultisigAddress</a></li><li><a href="global.html#DIRECT_KEYSTORES">DIRECT_KEYSTORES</a></li><li><a href="global.html#ExportExtendedPublicKey">ExportExtendedPublicKey</a></li><li><a href="global.html#ExportPublicKey">ExportPublicKey</a></li><li><a href="global.html#GetMetadata">GetMetadata</a></li><li><a href="global.html#INDIRECT_KEYSTORES">INDIRECT_KEYSTORES</a></li><li><a href="global.html#KEYSTORES">KEYSTORES</a></li><li><a href="global.html#SignMultisigTransaction">SignMultisigTransaction</a></li><li><a href="global.html#VERSION">VERSION</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Feb 11 2020 20:25:40 GMT-0700 (Mountain Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
